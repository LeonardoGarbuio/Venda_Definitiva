<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Finalizar Pedido - MotoDelivery</title>
    <link rel="stylesheet" href="../css/main.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
<script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fmotodelive8457back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.8"></script>
</head>
<body class="min-h-screen bg-gradient-to-br from-primary-50 to-accent-50">
    <!-- Header with Cart Summary -->
    <header class="bg-white shadow-subtle border-b border-gray-100 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo -->
                <div class="flex items-center space-x-3">
                    <div class="bg-primary text-white p-2 rounded-lg">
                        <i class="fas fa-motorcycle text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-heading font-bold text-secondary">MotoDelivery</h1>
                        <p class="text-xs text-text-secondary">Finalizar Pedido</p>
                    </div>
                </div>
                
                <!-- Cart Summary -->
                <div class="flex items-center space-x-4">
                    <div class="hidden sm:flex items-center space-x-2 bg-primary-50 px-3 py-2 rounded-lg">
                        <i class="fas fa-shopping-cart text-primary"></i>
                        <span class="text-sm font-semibold text-secondary">3 itens</span>
                        <span class="text-sm font-bold text-primary">R$ 45,90</span>
                    </div>
                    
                    <!-- Mobile Menu Button -->
                    <button class="md:hidden text-text-secondary hover:text-primary" onclick="toggleMobileMenu()">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Cart Summary -->
        <div class="sm:hidden bg-primary-50 px-4 py-2 border-t border-primary-100">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <i class="fas fa-shopping-cart text-primary"></i>
                    <span class="text-sm font-semibold text-secondary">3 itens no carrinho</span>
                </div>
                <span class="text-lg font-bold text-primary">R$ 45,90</span>
            </div>
        </div>

        <!-- Mobile Navigation -->
        <div id="mobileMenu" class="md:hidden hidden bg-white border-t border-gray-100">
            <div class="px-4 py-3 space-y-3">
                <a href="customer_order_menu.html" class="flex items-center text-text-secondary hover:text-primary transition-colors duration-200">
                    <i class="fas fa-utensils mr-3"></i>Cardápio
                </a>
                <a href="motoboy_registration.html" class="flex items-center text-text-secondary hover:text-primary transition-colors duration-200">
                    <i class="fas fa-user-plus mr-3"></i>Cadastro Motoboy
                </a>
                <a href="admin_login.html" class="flex items-center text-text-secondary hover:text-primary transition-colors duration-200">
                    <i class="fas fa-shield-alt mr-3"></i>Admin
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <!-- Progress Indicator -->
            <div class="mb-8">
                <div class="flex items-center justify-center space-x-4">
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-success text-white rounded-full flex items-center justify-center">
                            <i class="fas fa-check text-sm"></i>
                        </div>
                        <span class="ml-2 text-sm font-medium text-success">Cardápio</span>
                    </div>
                    <div class="w-16 h-1 bg-success rounded"></div>
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-primary text-white rounded-full flex items-center justify-center">
                            <i class="fas fa-shopping-cart text-sm"></i>
                        </div>
                        <span class="ml-2 text-sm font-medium text-primary">Finalizar</span>
                    </div>
                    <div class="w-16 h-1 bg-gray-200 rounded"></div>
                    <div class="flex items-center">
                        <div class="w-8 h-8 bg-gray-200 text-gray-400 rounded-full flex items-center justify-center">
                            <i class="fas fa-check text-sm"></i>
                        </div>
                        <span class="ml-2 text-sm font-medium text-gray-400">Confirmação</span>
                    </div>
                </div>
            </div>

            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Checkout Form -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Delivery Address Section -->
                    <div class="card-elevated p-6">
                        <h2 class="text-xl font-heading font-bold text-secondary mb-4 flex items-center">
                            <i class="fas fa-map-marker-alt text-primary mr-3"></i>
                            Endereço de Entrega
                        </h2>
                        
                        <form id="checkoutForm" class="space-y-4">
                            <!-- CEP Field -->
                            <div class="grid sm:grid-cols-2 gap-4">
                                <div>
                                    <label for="cep" class="block text-sm font-semibold text-secondary mb-2">
                                        CEP *
                                    </label>
                                    <input type="text" id="cep" name="cep" class="form-input" placeholder="00000-000" maxlength="9" required oninput="formatCEP(this); validateCEP(this)" />
                                    <div id="cepError" class="text-error text-sm mt-1 hidden">
                                        <i class="fas fa-exclamation-circle mr-1"></i>
                                        <span>CEP inválido</span>
                                    </div>
                                </div>
                                <div>
                                    <label for="city" class="block text-sm font-semibold text-secondary mb-2">
                                        Cidade *
                                    </label>
                                    <input type="text" id="city" name="city" class="form-input bg-gray-50" placeholder="Cidade" readonly required />
                                </div>
                            </div>

                            <!-- Address Fields -->
                            <div>
                                <label for="street" class="block text-sm font-semibold text-secondary mb-2">
                                    Rua *
                                </label>
                                <input type="text" id="street" name="street" class="form-input" placeholder="Nome da rua" required />
                            </div>

                            <div class="grid sm:grid-cols-3 gap-4">
                                <div>
                                    <label for="number" class="block text-sm font-semibold text-secondary mb-2">
                                        Número *
                                    </label>
                                    <input type="text" id="number" name="number" class="form-input" placeholder="123" required />
                                </div>
                                <div>
                                    <label for="complement" class="block text-sm font-semibold text-secondary mb-2">
                                        Complemento
                                    </label>
                                    <input type="text" id="complement" name="complement" class="form-input" placeholder="Apto, Bloco..." />
                                </div>
                                <div>
                                    <label for="neighborhood" class="block text-sm font-semibold text-secondary mb-2">
                                        Bairro *
                                    </label>
                                    <input type="text" id="neighborhood" name="neighborhood" class="form-input" placeholder="Bairro" required />
                                </div>
                            </div>

                            <!-- Map Preview -->
                            <div class="mt-4">
                                <div id="mapPreview" class="w-full h-48 bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center">
                                    <div class="text-center text-gray-500">
                                        <i class="fas fa-map text-3xl mb-2"></i>
                                        <p class="text-sm">Preencha o endereço para ver no mapa</p>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>

                    <!-- Contact Information -->
                    <div class="card-elevated p-6">
                        <h2 class="text-xl font-heading font-bold text-secondary mb-4 flex items-center">
                            <i class="fas fa-user text-primary mr-3"></i>
                            Informações de Contato
                        </h2>
                        
                        <div class="grid sm:grid-cols-2 gap-4">
                            <div>
                                <label for="customerName" class="block text-sm font-semibold text-secondary mb-2">
                                    Nome Completo *
                                </label>
                                <input type="text" id="customerName" name="customerName" class="form-input" placeholder="Seu nome completo" required />
                            </div>
                            <div>
                                <label for="phone" class="block text-sm font-semibold text-secondary mb-2">
                                    Telefone *
                                </label>
                                <input type="tel" id="phone" name="phone" class="form-input" placeholder="(11) 99999-9999" required oninput="formatPhone(this)" />
                            </div>
                        </div>

                        <div class="mt-4">
                            <label for="notes" class="block text-sm font-semibold text-secondary mb-2">
                                Observações para Entrega
                            </label>
                            <textarea id="notes" name="notes" class="form-input" rows="3" placeholder="Instruções especiais para o entregador..."></textarea>
                        </div>
                    </div>

                    <!-- Payment Method -->
                    <div class="card-elevated p-6">
                        <h2 class="text-xl font-heading font-bold text-secondary mb-4 flex items-center">
                            <i class="fas fa-credit-card text-primary mr-3"></i>
                            Forma de Pagamento
                        </h2>
                        
                        <div class="space-y-3">
                            <label class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors duration-200">
                                <input type="radio" name="paymentMethod" value="cash" class="w-4 h-4 text-primary border-gray-300 focus:ring-primary" checked />
                                <div class="ml-3 flex items-center justify-between w-full">
                                    <div class="flex items-center">
                                        <i class="fas fa-money-bill-wave text-success mr-3"></i>
                                        <div>
                                            <p class="font-semibold text-secondary">Dinheiro</p>
                                            <p class="text-sm text-text-secondary">Pagamento na entrega</p>
                                        </div>
                                    </div>
                                    <span class="status-indicator status-success">Disponível</span>
                                </div>
                            </label>

                            <label class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors duration-200">
                                <input type="radio" name="paymentMethod" value="card" class="w-4 h-4 text-primary border-gray-300 focus:ring-primary" />
                                <div class="ml-3 flex items-center justify-between w-full">
                                    <div class="flex items-center">
                                        <i class="fas fa-credit-card text-primary mr-3"></i>
                                        <div>
                                            <p class="font-semibold text-secondary">Cartão na Entrega</p>
                                            <p class="text-sm text-text-secondary">Débito ou crédito</p>
                                        </div>
                                    </div>
                                    <span class="status-indicator status-success">Disponível</span>
                                </div>
                            </label>

                            <label class="flex items-center p-4 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors duration-200">
                                <input type="radio" name="paymentMethod" value="pix" class="w-4 h-4 text-primary border-gray-300 focus:ring-primary" />
                                <div class="ml-3 flex items-center justify-between w-full">
                                    <div class="flex items-center">
                                        <i class="fas fa-qrcode text-accent mr-3"></i>
                                        <div>
                                            <p class="font-semibold text-secondary">PIX</p>
                                            <p class="text-sm text-text-secondary">Pagamento instantâneo</p>
                                        </div>
                                    </div>
                                    <span class="status-indicator status-success">Disponível</span>
                                </div>
                            </label>
                        </div>

                        <!-- Change Field for Cash Payment -->
                        <div id="changeField" class="mt-4">
                            <label for="changeAmount" class="block text-sm font-semibold text-secondary mb-2">
                                Troco para quanto?
                            </label>
                            <input type="text" id="changeAmount" name="changeAmount" class="form-input" placeholder="R$ 50,00" oninput="formatCurrency(this)" />
                        </div>
                    </div>
                </div>

                <!-- Order Summary Sidebar -->
                <div class="lg:col-span-1">
                    <div class="card-elevated p-6 sticky top-24">
                        <h2 class="text-xl font-heading font-bold text-secondary mb-4 flex items-center">
                            <i class="fas fa-receipt text-primary mr-3"></i>
                            Resumo do Pedido
                        </h2>
                        
                        <!-- Order Items -->
                        <div class="space-y-4 mb-6">
                            <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                                <img src="https://images.pexels.com/photos/1566837/pexels-photo-1566837.jpeg?auto=compress&cs=tinysrgb&w=80&h=80&fit=crop" alt="X-Bacon" class="w-12 h-12 object-cover rounded-lg" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                                <div class="flex-1">
                                    <h4 class="font-semibold text-secondary">X-Bacon</h4>
                                    <p class="text-sm text-text-secondary">Quantidade: 2</p>
                                </div>
                                <span class="font-bold text-primary">R$ 24,90</span>
                            </div>

                            <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                                <img src="https://images.pixabay.com/photo/2020/10/05/19/55/hamburger-5630646_960_720.jpg" alt="Batata Frita" class="w-12 h-12 object-cover rounded-lg" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                                <div class="flex-1">
                                    <h4 class="font-semibold text-secondary">Batata Frita</h4>
                                    <p class="text-sm text-text-secondary">Quantidade: 1</p>
                                </div>
                                <span class="font-bold text-primary">R$ 12,00</span>
                            </div>

                            <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                                <img src="https://images.unsplash.com/photo-1544145945-f90425340c7e?auto=format&fit=crop&w=80&h=80" alt="Refrigerante" class="w-12 h-12 object-cover rounded-lg" loading="lazy" onerror="this.src='https://images.unsplash.com/photo-1584824486509-112e4181ff6b?q=80&w=2940&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D'; this.onerror=null;" />
                                <div class="flex-1">
                                    <h4 class="font-semibold text-secondary">Refrigerante</h4>
                                    <p class="text-sm text-text-secondary">Quantidade: 1</p>
                                </div>
                                <span class="font-bold text-primary">R$ 9,00</span>
                            </div>
                        </div>

                        <!-- Order Totals -->
                        <div class="border-t border-gray-200 pt-4 space-y-2">
                            <div class="flex justify-between text-sm">
                                <span class="text-text-secondary">Subtotal</span>
                                <span class="font-semibold text-secondary">R$ 45,90</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-text-secondary">Taxa de Entrega</span>
                                <span class="font-semibold text-secondary">R$ 5,00</span>
                            </div>
                            <div class="flex justify-between text-lg font-bold border-t border-gray-200 pt-2">
                                <span class="text-secondary">Total</span>
                                <span class="text-primary">R$ 50,90</span>
                            </div>
                        </div>

                        <!-- Delivery Time -->
                        <div class="mt-6 p-4 bg-accent-50 rounded-lg border border-accent-200">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center">
                                    <i class="fas fa-clock text-accent mr-2"></i>
                                    <span class="text-sm font-semibold text-accent-800">Tempo de Entrega</span>
                                </div>
                                <span class="text-sm font-bold text-accent-800">30-45 min</span>
                            </div>
                        </div>

                        <!-- Security Badge -->
                        <div class="mt-4 flex items-center justify-center space-x-2 text-xs text-text-secondary">
                            <i class="fas fa-shield-alt text-success"></i>
                            <span>Pedido 100% seguro</span>
                        </div>

                        <!-- Confirm Order Button -->
                        <button type="button" id="confirmOrderBtn" class="w-full btn-primary mt-6 text-lg py-4" onclick="confirmOrder()">
                            <i class="fas fa-check-circle mr-2"></i>
                            Confirmar Pedido
                        </button>

                        <!-- Back to Menu Link -->
                        <div class="text-center mt-4">
                            <a href="customer_order_menu.html" class="text-primary hover:text-primary-600 text-sm font-medium transition-colors duration-200">
                                <i class="fas fa-arrow-left mr-1"></i>Voltar ao Cardápio
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-100 py-6 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center text-text-secondary text-sm">
                <p>&copy; 2025 MotoDelivery. Todos os direitos reservados.</p>
                <p class="mt-1">Entrega rápida e segura em toda a cidade</p>
            </div>
        </div>
    </footer>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg p-8 max-w-md w-full text-center">
            <div class="w-16 h-16 bg-success-100 text-success rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-check text-2xl"></i>
            </div>
            <h3 class="text-xl font-heading font-bold text-secondary mb-2">Pedido Confirmado!</h3>
            <p class="text-text-secondary mb-6">Seu pedido foi recebido e está sendo preparado. Você receberá atualizações por WhatsApp.</p>
            <div class="space-y-3">
                <div class="text-sm text-text-secondary">
                    <strong>Número do Pedido:</strong> #MD2025001
                </div>
                <div class="text-sm text-text-secondary">
                    <strong>Tempo Estimado:</strong> 30-45 minutos
                </div>
            </div>
            <button class="w-full btn-primary mt-6" onclick="closeSuccessModal()">
                Acompanhar Pedido
            </button>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Mobile menu toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('hidden');
        }

        // CEP formatting and validation
        function formatCEP(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 5) {
                value = value.replace(/^(\d{5})(\d)/, '$1-$2');
            }
            input.value = value;
        }

        function validateCEP(input) {
            const cepError = document.getElementById('cepError');
            const cepRegex = /^\d{5}-?\d{3}$/;
            
            if (input.value && !cepRegex.test(input.value)) {
                cepError.classList.remove('hidden');
                input.classList.add('border-error', 'focus:ring-error');
                input.classList.remove('border-gray-200', 'focus:ring-primary');
            } else {
                cepError.classList.add('hidden');
                input.classList.remove('border-error', 'focus:ring-error');
                input.classList.add('border-gray-200', 'focus:ring-primary');
                
                // Mock CEP lookup
                if (input.value.length === 9) {
                    lookupCEP(input.value);
                }
            }
        }

        // Mock CEP lookup
        function lookupCEP(cep) {
            const cityField = document.getElementById('city');
            const streetField = document.getElementById('street');
            const neighborhoodField = document.getElementById('neighborhood');
            const mapPreview = document.getElementById('mapPreview');
            
            // Simulate API call delay
            setTimeout(() => {
                // Mock data
                cityField.value = 'São Paulo';
                streetField.value = 'Rua das Flores';
                neighborhoodField.value = 'Centro';
                
                // Update map preview
                mapPreview.innerHTML = `
                    <div class="w-full h-full bg-gradient-to-br from-primary-100 to-accent-100 rounded-lg flex items-center justify-center">
                        <div class="text-center">
                            <i class="fas fa-map-marker-alt text-primary text-3xl mb-2"></i>
                            <p class="text-sm font-semibold text-secondary">Localização Confirmada</p>
                            <p class="text-xs text-text-secondary">Centro, São Paulo</p>
                        </div>
                    </div>
                `;
            }, 500);
        }

        // Phone formatting
        function formatPhone(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 10) {
                value = value.replace(/^(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
            } else if (value.length > 6) {
                value = value.replace(/^(\d{2})(\d{4})(\d)/, '($1) $2-$3');
            } else if (value.length > 2) {
                value = value.replace(/^(\d{2})(\d)/, '($1) $2');
            }
            input.value = value;
        }

        // Currency formatting
        function formatCurrency(input) {
            let value = input.value.replace(/\D/g, '');
            if (value) {
                value = (parseInt(value) / 100).toLocaleString('pt-BR', {
                    style: 'currency',
                    currency: 'BRL'
                });
            }
            input.value = value;
        }

        // Payment method change handler
        document.addEventListener('DOMContentLoaded', function() {
            const paymentRadios = document.querySelectorAll('input[name="paymentMethod"]');
            const changeField = document.getElementById('changeField');
            
            paymentRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.value === 'cash') {
                        changeField.style.display = 'block';
                    } else {
                        changeField.style.display = 'none';
                    }
                });
            });
        });

        // Form validation
        function validateForm() {
            const requiredFields = [
                'cep', 'city', 'street', 'number', 'neighborhood', 
                'customerName', 'phone'
            ];
            
            let isValid = true;
            
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.classList.add('border-error', 'focus:ring-error');
                    field.classList.remove('border-gray-200', 'focus:ring-primary');
                    isValid = false;
                } else {
                    field.classList.remove('border-error', 'focus:ring-error');
                    field.classList.add('border-gray-200', 'focus:ring-primary');
                }
            });
            
            return isValid;
        }

        // Confirm order
        function confirmOrder() {
            if (!validateForm()) {
                showNotification('Por favor, preencha todos os campos obrigatórios.', 'error');
                return;
            }
            
            const confirmBtn = document.getElementById('confirmOrderBtn');
            
            // Show loading state
            confirmBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processando...';
            confirmBtn.disabled = true;
            
            // Simulate order processing
            setTimeout(() => {
                // Show success modal
                document.getElementById('successModal').classList.remove('hidden');
                
                // Reset button
                confirmBtn.innerHTML = '<i class="fas fa-check-circle mr-2"></i>Confirmar Pedido';
                confirmBtn.disabled = false;
            }, 2000);
        }

        // Close success modal
        function closeSuccessModal() {
            document.getElementById('successModal').classList.add('hidden');
            // Redirect to order tracking or menu
            window.location.href = 'customer_order_menu.html';
        }

        // Notification system
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transition-all duration-300 transform translate-x-full`;
            
            if (type === 'success') {
                notification.classList.add('bg-success-100', 'text-success-800', 'border', 'border-success-200');
                notification.innerHTML = `<i class="fas fa-check-circle mr-2"></i>${message}`;
            } else {
                notification.classList.add('bg-error-100', 'text-error-800', 'border', 'border-error-200');
                notification.innerHTML = `<i class="fas fa-exclamation-circle mr-2"></i>${message}`;
            }
            
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Auto-save form data to localStorage
        function saveFormData() {
            const formData = {
                cep: document.getElementById('cep').value,
                city: document.getElementById('city').value,
                street: document.getElementById('street').value,
                number: document.getElementById('number').value,
                complement: document.getElementById('complement').value,
                neighborhood: document.getElementById('neighborhood').value,
                customerName: document.getElementById('customerName').value,
                phone: document.getElementById('phone').value,
                notes: document.getElementById('notes').value,
                paymentMethod: document.querySelector('input[name="paymentMethod"]:checked')?.value,
                changeAmount: document.getElementById('changeAmount').value
            };
            
            localStorage.setItem('checkoutFormData', JSON.stringify(formData));
        }

        // Load saved form data
        function loadFormData() {
            const savedData = localStorage.getItem('checkoutFormData');
            if (savedData) {
                const formData = JSON.parse(savedData);
                
                Object.keys(formData).forEach(key => {
                    const field = document.getElementById(key);
                    if (field && formData[key]) {
                        if (key === 'paymentMethod') {
                            const radio = document.querySelector(`input[name="paymentMethod"][value="${formData[key]}"]`);
                            if (radio) radio.checked = true;
                        } else {
                            field.value = formData[key];
                        }
                    }
                });
            }
        }

        // Initialize form
        document.addEventListener('DOMContentLoaded', function() {
            loadFormData();
            
            // Auto-save on input
            const formInputs = document.querySelectorAll('#checkoutForm input, #checkoutForm textarea');
            formInputs.forEach(input => {
                input.addEventListener('input', saveFormData);
                input.addEventListener('change', saveFormData);
            });
        });
    </script>
<script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>
</html>